<script>
document.addEventListener('DOMContentLoaded', () => {
  const selectors = ['.about-hero', '.daily-card', '.page-list-item'];
  const cards = document.querySelectorAll(selectors.join(', '));
  if (!cards.length) return;

  const interactiveSelector = 'a, button, input, textarea, select, label';

  cards.forEach((card) => {
    let isDragging = false;
    let activePointer = null;

    const updateTilt = (event) => {
      const rect = card.getBoundingClientRect();
      const offsetX = event.clientX - (rect.left + rect.width / 2);
      const offsetY = event.clientY - (rect.top + rect.height / 2);
      const rotateY = (offsetX / (rect.width / 2)) * 10;
      const rotateX = (-offsetY / (rect.height / 2)) * 10;
      card.style.transform = `perspective(1200px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
    };

    const resetTilt = () => {
      card.style.transition = 'transform 0.5s ease';
      card.style.transform = 'perspective(1200px) rotateX(0deg) rotateY(0deg)';
      setTimeout(() => {
        card.style.transition = '';
      }, 500);
    };

    card.addEventListener('pointerdown', (event) => {
      if (event.button !== undefined && event.button !== 0) return;
      if (event.target.closest(interactiveSelector)) return;
      isDragging = true;
      activePointer = event.pointerId;
      card.setPointerCapture(activePointer);
      card.style.transition = '';
      updateTilt(event);
    });

    card.addEventListener('pointermove', (event) => {
      if (!isDragging || event.pointerId !== activePointer) return;
      updateTilt(event);
    });

    const endDrag = (event) => {
      if (!isDragging || event.pointerId !== activePointer) return;
      isDragging = false;
      card.releasePointerCapture(activePointer);
      activePointer = null;
      resetTilt();
    };

    card.addEventListener('pointerup', endDrag);
    card.addEventListener('pointercancel', endDrag);
    card.addEventListener('pointerleave', () => {
      if (!isDragging) return;
      isDragging = false;
      if (activePointer !== null) {
        card.releasePointerCapture(activePointer);
      }
      activePointer = null;
      resetTilt();
    });
  });
});
</script>
