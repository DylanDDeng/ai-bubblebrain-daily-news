<div class="gallery-comments-slot gallery-comments-slot--page">
  {{- $threadPath := .RelPermalink -}}
  {{- range .AllTranslations -}}
    {{- if eq .Language.LanguageCode "zh-CN" -}}
      {{- $threadPath = .RelPermalink -}}
    {{- end -}}
  {{- end -}}
  {{- $threadId := printf "page:%s" $threadPath -}}

  <section class="gallery-comments open gallery-comments--expanded" data-supabase-comments data-thread-id="{{ $threadId }}" aria-label="{{ i18n "comments_title" }}">
    <div class="gallery-comments__toggle gallery-comments__toggle--static">
      <span class="gallery-comments__title">{{ i18n "comments_title" }}</span>
      <span class="gallery-comments__meta">
        <span class="gallery-comments__count" data-comments-count>0</span>
      </span>
    </div>

    <div class="gallery-comments__panel" data-comments-panel>
      <div class="gallery-comments__status" data-comments-status></div>
      <div class="gallery-comments__list" data-comments-list></div>
      <div class="gallery-comments__list-actions">
        <button class="gallery-comments__btn" type="button" data-comments-more hidden>{{ i18n "gallery_comments_load_more" }}</button>
      </div>

      <form class="gallery-comments__composer" data-comments-composer>
        <div class="gallery-comments__login-hint" data-comments-login-hint hidden>{{ i18n "gallery_comments_login_to_comment" }}</div>
        <div class="gallery-comments__fields" data-comments-fields>
          <label class="gallery-comments__label">
            <span>{{ i18n "gallery_comments_type_label" }}</span>
            <select class="gallery-comments__select" data-comments-type>
              <option value="question">{{ i18n "gallery_comments_type_question" }}</option>
              <option value="repro">{{ i18n "gallery_comments_type_repro" }}</option>
              <option value="suggestion">{{ i18n "gallery_comments_type_suggestion" }}</option>
            </select>
          </label>
          <textarea class="gallery-comments__textarea" data-comments-text rows="3" placeholder="{{ i18n "gallery_comments_placeholder" }}"></textarea>
          <div class="gallery-comments__composer-actions">
            <button class="gallery-comments__send" data-comments-submit type="submit">{{ i18n "gallery_comments_send" }}</button>
          </div>
        </div>
      </form>
    </div>
  </section>

  {{- $commentsI18N := dict
      "loading" (i18n "gallery_comments_loading")
      "empty" (i18n "gallery_comments_empty")
      "loadMore" (i18n "gallery_comments_load_more")
      "reply" (i18n "gallery_comments_reply")
      "cancel" (i18n "gallery_comments_collapse")
      "delete" (i18n "gallery_comments_delete")
      "expandReplies" (i18n "gallery_comments_expand_replies")
      "collapseReplies" (i18n "gallery_comments_collapse_replies")
      "loginToComment" (i18n "gallery_comments_login_to_comment")
      "placeholder" (i18n "gallery_comments_placeholder")
      "send" (i18n "gallery_comments_send")
      "typeQuestion" (i18n "gallery_comments_type_question")
      "typeRepro" (i18n "gallery_comments_type_repro")
      "typeSuggestion" (i18n "gallery_comments_type_suggestion")
      "unavailable" (i18n "gallery_comments_unavailable")
      "loadFailed" (i18n "gallery_comments_load_failed")
      "sendFailed" (i18n "gallery_comments_send_failed")
      "deleteConfirm" (i18n "gallery_comments_delete_confirm")
      "deleteFailed" (i18n "gallery_comments_delete_failed")
    -}}
  <script>
    window.SUPABASE_COMMENTS_I18N = {{ $commentsI18N | jsonify | safeJS }};
  </script>
  <script defer src="{{ "js/supabase-comments.js" | relURL }}"></script>
</div>
