<section class="comments-section">
  <h2 class="comments-title">{{ i18n "comments_title" }}</h2>
  {{- $threadPath := .RelPermalink -}}
  {{- range .AllTranslations -}}
    {{- if eq .Language.LanguageCode "zh-CN" -}}
      {{- $threadPath = .RelPermalink -}}
    {{- end -}}
  {{- end -}}
  {{- $threadId := printf "page:%s" $threadPath -}}

  <div class="supabase-comments" data-supabase-comments data-thread-id="{{ $threadId }}">
    <div class="supabase-comments__status" data-comments-status hidden></div>
    <div class="supabase-comments__list" data-comments-list></div>
    <div class="supabase-comments__list-actions">
      <button class="supabase-comments__btn" type="button" data-comments-more hidden>{{ i18n "gallery_comments_load_more" }}</button>
    </div>

    <div class="supabase-comments__composer">
      <div class="supabase-comments__login-hint" data-comments-login-hint hidden>{{ i18n "gallery_comments_login_to_comment" }}</div>
      <form class="supabase-comments__fields" data-comments-form>
        <textarea class="supabase-comments__textarea" data-comments-text rows="3" placeholder="{{ i18n "gallery_comments_placeholder" }}"></textarea>
        <div class="supabase-comments__composer-actions">
          <button class="supabase-comments__send" data-comments-submit type="submit">{{ i18n "gallery_comments_send" }}</button>
        </div>
      </form>
    </div>
  </div>

  {{- $commentsI18N := dict
      "loading" (i18n "gallery_comments_loading")
      "empty" (i18n "gallery_comments_empty")
      "loadMore" (i18n "gallery_comments_load_more")
      "reply" (i18n "gallery_comments_reply")
      "cancel" (i18n "gallery_comments_collapse")
      "delete" (i18n "gallery_comments_delete")
      "expandReplies" (i18n "gallery_comments_expand_replies")
      "collapseReplies" (i18n "gallery_comments_collapse_replies")
      "loginToComment" (i18n "gallery_comments_login_to_comment")
      "placeholder" (i18n "gallery_comments_placeholder")
      "send" (i18n "gallery_comments_send")
      "unavailable" (i18n "gallery_comments_unavailable")
      "loadFailed" (i18n "gallery_comments_load_failed")
      "sendFailed" (i18n "gallery_comments_send_failed")
      "deleteConfirm" (i18n "gallery_comments_delete_confirm")
      "deleteFailed" (i18n "gallery_comments_delete_failed")
    -}}
  <script>
    window.SUPABASE_COMMENTS_I18N = {{ $commentsI18N | jsonify | safeJS }};
  </script>
  <script defer src="{{ "js/supabase-comments.js" | relURL }}"></script>
</section>
